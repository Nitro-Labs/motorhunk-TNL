(()=>{var m=function(){let e=document.getElementById("grid_style_list");if(!e)return;let{container:s}=this,n=[...s.classList].join(" "),{productGridContainer:l}=this.elms;e.children.forEach(i=>{let t=i.dataset.class,r=i.dataset.style;i.addEvent("click",()=>{l.className=t,s.className=`${n} ${r}`})})};function p(){let{sidebarContainer:e}=this.elms;if(!e)return;let s=e.querySelectorAll(".featured_block-filter_group"),n=this.elms.sidebarContainer.dataset.filterType;function l(){theme.settings.collection.scrollTopWhenFilter&&AT.scrollTo(document.getElementById("main-layout").offsetTop-100)}s.forEach(i=>{let t=i.dataset.multiple==="true",r=i.querySelector(".filter-clear"),a=i.querySelectorAll(".tags-link"),c;a.forEach(d=>{let h=d.dataset.tagValue;d.addEvent("click",u=>{u.preventDefault(),d.hasClass("active")?(this.currentTags=this.currentTags.filter(o=>o!=h),c="remove"):(!t&&n!="attribute"&&[...a].filter(o=>o.hasClass("active")).forEach(o=>(o.removeClass("active"),this.currentTags=this.currentTags.filter(C=>C!=o.dataset.tagValue))),this.currentTags.push(h),c="add"),r.addClass("pending"),r.removeClass("d-none"),this.getProductList(this.getUrlAjaxRequest(null,"filter",d)).then(()=>{switch(c){case"add":d.addClass("active");break;case"remove":d.removeClass("active"),[...a].find(o=>o.hasClass("active"))||r.addClass("d-none");break}r.removeClass("pending"),l()})})}),r?.addEvent("click",d=>{d.preventDefault();let h=[...a].map(o=>o.hasClass("active")&&o.dataset.tagValue).filter(Boolean);this.currentTags=this.currentTags.filter(o=>!h.includes(o)),r.addClass("pending");let u;n=="attribute"?u=r.href:u=this.getUrlAjaxRequest(null,"filter"),this.getProductList(u).then(()=>{r.addClass("d-none"),r.removeClass("pending"),a.forEach(o=>o.removeClass("active")),l()})})}),e.querySelector(".js-filter-form")?.addEventListener("submit",i=>{i.preventDefault();let t=new FormData(i.target),r=new URLSearchParams(t).toString(),a=document.createElement("a");a.href=`${i.target.action}?${r}`,this.getProductList(this.getUrlAjaxRequest(null,"filter",a))})}var f={onLoad:function(){let{container:e}=this;Object.assign(this,theme.collection),!this.currentTags&&(this.currentTags=[]),this.elms={sortContainer:e.querySelector(".js-collection-sort-container"),selectDesk:document.getElementById("select_desk"),selectDeskTitle:document.getElementById("select_desk_title"),selectDeskContainer:document.getElementById("select_desk_container"),productItems:[...e.getElementsByClassName("product-section")],infiniteBtn:e.querySelector(".js-infinite-btn"),productGridContainer:e.querySelector("#product-grid-container"),collectionPaginationContainer:e.querySelector(".js-colletion-pagination-container"),paginationShowing:e.querySelector(".js-pagination-showing"),sidebarContainer:e.querySelector("#sidebarDrawer"),toggleSbButton:e.getElementsByClassName("js-toggle-sb"),filterContainer:document.querySelector(".js-filter-container")},this.initSortCollection(),this.initCollapse(),this.getProductList(this.getUrlAjaxRequest()),p.call(this),this.initToggleSidebar(),this.initFilter(),m.call(this)},initFilter(){let{filterContainer:e}=this.elms;!e||(typeof Filter!="undefined"?new Filter(e):AT.loadCollectionFilter().then(()=>{new Filter(e)}))},initSortCollection:function(){let{sortContainer:e}=this.elms,s=e.querySelector("#select_desk_container"),n=e.querySelector("#select_desk"),l=s.querySelector("#select_desk_title"),t=e.querySelector("#mobile-select-container").firstElementChild;s.addEvent("click",function(){this.hasClass("is-open")?this.removeClass("is-open"):this.addClass("is-open")}),document.addEvent("click",r=>{s.contains(r.target)||s.removeClass("is-open")}),n.children.addEvents("click",function(){let r=this.innerHTML,a=this.dataset.value;l.innerHTML=r,t.value=a,t.dispatchEvent(new Event("change"))}),t.addEvent("change",r=>{let{value:a}=r.target;this.getProductList(this.getUrlAjaxRequest(a,"sort-by"))})},getUrlAjaxRequest:function(e,s){let n="",l;switch(window.location.href.includes("vendors")&&(l=AT.getParameterByName("q")),s){case"sort-by":{if(l){let i=[...window.location.search.replace("?","").split("&").filter(t=>!t.includes("sort_by")),`sort_by=${e}`,"view=ajax-request"];n=`${window.location.pathname}?${i.join("&")}`,console.log(n)}else if(window.location.search)if(location.search.includes("sort_by")){let i=location.search.split("&");i=i.map(t=>t.includes("sort_by")?t.split("=")[0]+"="+e:t),i.push("view=ajax-request"),n=`${location.origin}${location.pathname}${i.join("&")}`}else n=`${location.href}&sort_by=${e}&view=ajax-request`;else n=`${location.href}?sort_by=${e}&view=ajax-request`;break}case"filter":{if(l){let i=[this.currentTags.length?`constraint=${encodeURIComponent(this.currentTags.join("+"))}`:"",...window.location.search.replace("?","").split("&").filter(t=>!t.includes("constraint")&&!t.includes("page")),"view=ajax-request"].filter(Boolean).join("&");n=`${window.location.pathname}?${i}`}else if(location.search){let i=location.search.split("&");i=i.map(t=>t.includes("page=")&&+t.split("=")[1]>1?t.split("=")[0]+"=1":t),n=`${this.url}${this.currentTags.length?"/"+this.currentTags.join("+"):""}${i.join("&")}&view=ajax-request`}else n=`${this.url}${this.currentTags.length?"/"+this.currentTags.join("+"):""}?view=ajax-request`;break}default:window.location.search?n=`${this.url.includes("collections/vendors")?window.location.pathname:this.url}${this.currentTags.length?"/"+this.currentTags.join("+"):""}${window.location.search}&view=ajax-request`:n=`${this.url.includes("collections/vendors")?window.location.pathname:this.url}${this.currentTags.length?"/"+this.currentTags.join("+"):""}?view=ajax-request`;break}return n},getProductList:function(e){let{productGridContainer:s,collectionPaginationContainer:n,paginationShowing:l}=this.elms;return fetch(e,{dataType:"text"}).then(i=>{let t=document.createElement("div");t.innerHTML=i;let r=t.querySelectorAll(".js-product-card"),a=t.querySelector(".collection-pagination");l.innerHTML=t.querySelector(".pagination-showing").innerHTML,r.length?(s.innerHTML="",r.forEach(c=>{ProductCard.initEvent(c),s.append(c)})):s.innerHTML=`<p class="text-center">${this.notFound}</p>`,n.innerHTML=a.innerHTML||"",n.querySelectorAll("a").forEach(c=>{c.href=AT.removeParam("view",c.href)}),history.replaceState({},"",e.replace("?view=ajax-request&","?").replace("?view=ajax-request","").replace("&view=ajax-request","")),document.title=t.querySelector(".page-title").textContent,typeof window.SPR!="undefined"&&(window.SPR.initDomEls(),window.SPR.loadBadges(),window.SPR.loadProducts())})},initCollapse:function(){this.container.getElementsByClassName("js-btn-collapse").addEvents("click",function(){this.hasClass("is-open")?(this.removeClass("is-open"),this.nextElementSibling.removeClass("is-open")):(this.addClass("is-open"),this.nextElementSibling.addClass("is-open"))})},initToggleSidebar:function(){let{toggleSbButton:e,sidebarContainer:s}=this.elms;!s||e.forEach(n=>{n.addEvent("click",function(){let{role:l}=n.dataset;switch(l){case"open":s.addClass("is-open");break;case"close":s.removeClass("is-open");break}})})}};(()=>{register("collection-no-sidebar",f),load("*"),console.log("collection-no-siddebar-page.js loaded")})();})();
